# HungryTales API Documentation

# Authentication

The authentication endpoint is responsible for restricting access to the `/recipe` endpoints. Entities must 
first register with the authentication endpoint and present valid tokens generated by this endpoint when interacting 
with the rest of the system.

# Register

Create a new user object in the persistence layer to perform a login with. Note that the **username** field is unique
in the system.

## POST /auth/register

### Content-Type
application/json

### Payload

| Field | Type | Mandatory |
|-------|------|-----------|
|Username|String|Yes|
|Password|String|Yes|
|Name|String|No|
|Surname|String|No|

### Example Data

#### Request
```json
{
  "username": "cooldude",
  "password": "MySuperSecretPassword",
  "name": "Cool",
  "surname": "Dude"
}
```

#### 200 Response
```json
{
  "result": true
}
```

#### 401 Response
```json
{
  "result": false,
  "errorMessage": "username already exists"
}
```

# Login

Perform a login using pre-registered credentials. Returns user data from the system as well as an auth token, valid for 
2 hours. After the token validity window has passed, the token must be presented to the refresh endpoint for a new token.

## POST /auth/login

### Content-Type

application/json

### Payload

| Field | Type | Mandatory |
|-------|------|-----------|
|Username|String|Yes|
|Password|String|Yes|

### Example Data

#### Request
```json
{
  "username": "cooldude",
  "password": "MySuperSecretPassword"
}
```

#### 200 Response
```json
{
  "result": true,
  "data": {
    "userDTO": {
      "id": 1,
      "username": "cooldude",
      "name": "Cool",
      "surname": "Dude"
    },
    "authToken": "KsRMxLZKMkmTmv0WfyMoxVMT5LSXN4IfQ8/X58OcFFeZosKR7GhhEArULN9F3TpD3923io1buM6W7g/bhJNRaOOKAvL4PbLmJB+WtHFi//8VFYfCJQdqhrAnWJCdvdkJB8WC6uIjGKYfBKguFR0wx4LCJf7T9IcOZbK+6BeGg9ZBywMzsxt3hKuYWrVVihtI4kJOOaxkMU+2l9dLw0RZFA+kiZMEucq27DAt1tiZjO52utzsK0Z8QtMigq05VfTbX8vHTSK6qN964PzCmJNJaQ5P98ERpaJ6YG7Y/PmSXjrcDoAVm087vpIR+wWgSGHxPoy+e8GmCYlhndfs26s0Iw=="
  }
}
```

#### 401 Response
```json
{
  "result": false,
  "errorMessage": "username/password was incorrect"
}
```

# Refresh

Receive a new token from a pre-existing token. The token must be passed in the `Authorization` header.

Passing a token to this endpoint burns the token, making it unusable for future requests. This makes it safe to call the 
refresh endpoint early and reduces the chances of a replay attack. 

## POST /auth/refresh

### Content-Type

application/json

### Authorization

Bearer <existing auth token>

### Example Data

#### 200 Response
```json
{
  "result": true,
  "data": {
    "authToken": "N+CgoN9fD9Wa4N9gUAtoMPHFPSK6/HmJq/ZrnZsvMBkiqi+zGInYzvJCkA2FBRINOutPNVdLu4sFC+jkeiUzZuVXmXfTBzYebEQNB0xlhJZg/Zo2L9a/05Si7JTasNF5BY6rqG0vMRod03UeLTfl1l7LZCftZ4xdmeCFu10rCmOC6+pcGXgsAp25UPXjKF1JmvTz+L95lvwj/lWw68UQLFTAm5LQpYxjZP89Gr9/YD4mlqdW4X6bStQmaLztLZqJChnAevIEHi28TXebjt8r/jDKL4CakyWCtXgltduva/gReys0Z+moo/iu2uAbu4XRcYpn24a/PiOgucIQkURP8g=="
  }
}
```
